{"ast":null,"code":"var _jsxFileName = \"/home/orv/Documents/Projects/offline/offline/client/src/pages/Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport styled from 'styled-components';\nimport axios from 'axios';\nimport { io } from 'socket.io-client';\nimport { useAuth } from '../context/AuthContext';\nimport Navigation from '../components/Navigation';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Chat = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [pendingMessages, setPendingMessages] = useState([]);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const socketRef = useRef();\n  const messagesEndRef = useRef(null);\n\n  // Scroll to the bottom of messages\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n\n  // Initialize socket connection\n  useEffect(() => {\n    // Get the server URL from the proxy or use localhost\n    const serverUrl = process.env.REACT_APP_API_URL || 'http://localhost:5000';\n    socketRef.current = io(serverUrl);\n\n    // Connect user\n    socketRef.current.emit('user_connected', user._id);\n\n    // Fetch existing messages\n    const fetchMessages = async () => {\n      try {\n        const {\n          data\n        } = await axios.get('/api/messages');\n        if (data.success) {\n          setMessages(data.messages);\n        }\n      } catch (error) {\n        console.error('Error fetching messages:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    // If user is admin, fetch pending messages\n    if (user.isAdmin) {\n      const fetchPendingMessages = async () => {\n        try {\n          const {\n            data\n          } = await axios.get('/api/messages/pending');\n          if (data.success) {\n            setPendingMessages(data.messages);\n          }\n        } catch (error) {\n          console.error('Error fetching pending messages:', error);\n        }\n      };\n      fetchPendingMessages();\n    }\n    fetchMessages();\n\n    // Clean up socket connection on unmount\n    return () => {\n      socketRef.current.disconnect();\n    };\n  }, [user._id, user.isAdmin]);\n\n  // Set up socket event listeners\n  useEffect(() => {\n    if (!socketRef.current) return;\n\n    // Receive approved messages\n    socketRef.current.on('approved_message', message => {\n      setMessages(prevMessages => [...prevMessages, message]);\n\n      // If this is one of the user's pending messages, remove it from pending\n      if (message.sender._id === user._id) {\n        setPendingMessages(prevPending => prevPending.filter(msg => msg._id !== message._id));\n      }\n    });\n\n    // Message was sent for approval\n    socketRef.current.on('message_sent_for_approval', messageId => {\n      console.log('Message sent for approval:', messageId);\n    });\n\n    // New pending message (admin only)\n    if (user.isAdmin) {\n      socketRef.current.on('pending_approval', message => {\n        setPendingMessages(prevPending => [...prevPending, message]);\n      });\n    }\n\n    // Message was rejected (admin only)\n    socketRef.current.on('message_rejected', messageId => {\n      setPendingMessages(prevPending => prevPending.filter(msg => msg._id !== messageId));\n    });\n\n    // Online users update\n    socketRef.current.on('online_users', users => {\n      setOnlineUsers(users);\n    });\n\n    // User disconnected\n    socketRef.current.on('user_disconnected', socketId => {\n      // This could be improved with more information from the server\n      console.log('User disconnected:', socketId);\n    });\n  }, [user._id, user.isAdmin]);\n\n  // Scroll to bottom when messages update\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Send a new message\n  const sendMessage = e => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n\n    // Send message through socket\n    socketRef.current.emit('send_public_message', {\n      sender: user._id,\n      content: newMessage.trim()\n    });\n\n    // Add to pending messages for current user\n    const pendingMsg = {\n      _id: Date.now().toString(),\n      // Temporary ID\n      sender: {\n        _id: user._id,\n        username: user.username\n      },\n      content: newMessage.trim(),\n      createdAt: new Date().toISOString(),\n      isPending: true // Custom flag to identify as pending in UI\n    };\n    setPendingMessages(prev => [...prev, pendingMsg]);\n\n    // Clear input\n    setNewMessage('');\n  };\n\n  // Approve a message (admin only)\n  const approveMessage = messageId => {\n    if (!user.isAdmin) return;\n    socketRef.current.emit('approve_message', messageId);\n  };\n\n  // Reject a message (admin only)\n  const rejectMessage = messageId => {\n    if (!user.isAdmin) return;\n    socketRef.current.emit('reject_message', messageId);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Navigation, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ChatContainer, {\n      children: [/*#__PURE__*/_jsxDEV(ChatSidebar, {\n        children: [/*#__PURE__*/_jsxDEV(SidebarSection, {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Online Users\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(OnlineUsersList, {\n            children: onlineUsers.map(onlineUser => /*#__PURE__*/_jsxDEV(OnlineUser, {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: onlineUser.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 19\n              }, this), onlineUser.isAdmin && /*#__PURE__*/_jsxDEV(AdminBadge, {\n                children: \"Admin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 42\n              }, this)]\n            }, onlineUser._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }, this), user.isAdmin && pendingMessages.length > 0 && /*#__PURE__*/_jsxDEV(SidebarSection, {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Messages Awaiting Approval\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(PendingMessagesList, {\n            children: pendingMessages.map(message => {\n              var _message$sender;\n              return /*#__PURE__*/_jsxDEV(PendingMessage, {\n                children: [/*#__PURE__*/_jsxDEV(PendingMessageHeader, {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: ((_message$sender = message.sender) === null || _message$sender === void 0 ? void 0 : _message$sender.username) || 'User'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 191,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(PendingTime, {\n                    children: new Date(message.createdAt).toLocaleTimeString()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 192,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 190,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(PendingMessageContent, {\n                  children: message.content\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 196,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(PendingMessageActions, {\n                  children: [/*#__PURE__*/_jsxDEV(ApproveButton, {\n                    onClick: () => approveMessage(message._id),\n                    children: \"Approve\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 198,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(RejectButton, {\n                    onClick: () => rejectMessage(message._id),\n                    children: \"Reject\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 201,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 197,\n                  columnNumber: 21\n                }, this)]\n              }, message._id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ChatMain, {\n        children: [/*#__PURE__*/_jsxDEV(ChatHeader, {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Public Chatroom\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Messages will be displayed after admin approval.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(MessagesContainer, {\n          children: [loading ? /*#__PURE__*/_jsxDEV(LoadingMessage, {\n            children: \"Loading messages...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 15\n          }, this) : messages.length === 0 ? /*#__PURE__*/_jsxDEV(EmptyMessage, {\n            children: \"No messages have been sent yet.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 15\n          }, this) : messages.map(message => /*#__PURE__*/_jsxDEV(MessageBubble, {\n            isOwnMessage: message.sender._id === user._id,\n            children: [/*#__PURE__*/_jsxDEV(MessageHeader, {\n              children: [/*#__PURE__*/_jsxDEV(MessageSender, {\n                children: message.sender.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(MessageTime, {\n                children: new Date(message.createdAt).toLocaleTimeString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(MessageContent, {\n              children: message.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 19\n            }, this)]\n          }, message._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 17\n          }, this)), pendingMessages.filter(message => message.sender._id === user._id).map(message => /*#__PURE__*/_jsxDEV(MessageBubble, {\n            isOwnMessage: true,\n            isPending: true,\n            children: [/*#__PURE__*/_jsxDEV(MessageHeader, {\n              children: [/*#__PURE__*/_jsxDEV(MessageSender, {\n                children: message.sender.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(MessageTime, {\n                children: new Date(message.createdAt).toLocaleTimeString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(MessageContent, {\n              children: message.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(PendingIndicator, {\n              children: \"Awaiting Approval\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 19\n            }, this)]\n          }, message._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 17\n          }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: messagesEndRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(MessageForm, {\n          onSubmit: sendMessage,\n          children: [/*#__PURE__*/_jsxDEV(MessageInput, {\n            type: \"text\",\n            value: newMessage,\n            onChange: e => setNewMessage(e.target.value),\n            placeholder: \"Type your message...\",\n            autoFocus: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SendButton, {\n            type: \"submit\",\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Chat, \"HZxXQ9NfnhflmCJjLud9+Bt93IY=\", false, function () {\n  return [useAuth];\n});\n_c = Chat;\nconst ChatContainer = styled.div`\n  display: flex;\n  height: calc(100vh - 60px);\n  max-width: 1400px;\n  margin: 0 auto;\n  background-color: #f8f9fa;\n`;\n_c2 = ChatContainer;\nconst ChatSidebar = styled.div`\n  width: 300px;\n  background-color: #fff;\n  border-left: 1px solid #e4e4e4;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n`;\n_c3 = ChatSidebar;\nconst SidebarSection = styled.div`\n  padding: 1.5rem;\n  border-bottom: 1px solid #e4e4e4;\n  \n  h3 {\n    margin-bottom: 1rem;\n    font-size: 1rem;\n    color: #2c3e50;\n  }\n`;\n_c4 = SidebarSection;\nconst OnlineUsersList = styled.ul`\n  list-style: none;\n  padding: 0;\n`;\n_c5 = OnlineUsersList;\nconst OnlineUser = styled.li`\n  padding: 0.5rem;\n  margin-bottom: 0.5rem;\n  background-color: #f8f9fa;\n  border-radius: 4px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n_c6 = OnlineUser;\nconst AdminBadge = styled.span`\n  background-color: #e74c3c;\n  color: white;\n  font-size: 0.7rem;\n  padding: 0.2rem 0.4rem;\n  border-radius: 3px;\n`;\n_c7 = AdminBadge;\nconst PendingMessagesList = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  max-height: 400px;\n  overflow-y: auto;\n`;\n_c8 = PendingMessagesList;\nconst PendingMessage = styled.div`\n  background-color: #f8f9fa;\n  border: 1px solid #e4e4e4;\n  border-radius: 4px;\n  padding: 1rem;\n`;\n_c9 = PendingMessage;\nconst PendingMessageHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n  \n  span {\n    font-weight: 500;\n  }\n`;\n_c0 = PendingMessageHeader;\nconst PendingTime = styled.span`\n  font-size: 0.8rem;\n  color: #7f8c8d;\n`;\n_c1 = PendingTime;\nconst PendingMessageContent = styled.p`\n  margin-bottom: 1rem;\n`;\n_c10 = PendingMessageContent;\nconst PendingMessageActions = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  gap: 0.5rem;\n`;\n_c11 = PendingMessageActions;\nconst ApproveButton = styled.button`\n  background-color: #2ecc71;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 0.5rem 0.8rem;\n  font-size: 0.8rem;\n  cursor: pointer;\n  \n  &:hover {\n    background-color: #27ae60;\n  }\n`;\n_c12 = ApproveButton;\nconst RejectButton = styled.button`\n  background-color: #e74c3c;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 0.5rem 0.8rem;\n  font-size: 0.8rem;\n  cursor: pointer;\n  \n  &:hover {\n    background-color: #c0392b;\n  }\n`;\n_c13 = RejectButton;\nconst ChatMain = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n`;\n_c14 = ChatMain;\nconst ChatHeader = styled.div`\n  padding: 1.5rem;\n  background-color: #fff;\n  border-bottom: 1px solid #e4e4e4;\n  text-align: center;\n  \n  h2 {\n    margin-bottom: 0.5rem;\n  }\n  \n  p {\n    color: #7f8c8d;\n    font-size: 0.9rem;\n  }\n`;\n_c15 = ChatHeader;\nconst MessagesContainer = styled.div`\n  flex: 1;\n  padding: 1.5rem;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n`;\n_c16 = MessagesContainer;\nconst LoadingMessage = styled.div`\n  text-align: center;\n  color: #7f8c8d;\n  margin: 2rem 0;\n`;\n_c17 = LoadingMessage;\nconst EmptyMessage = styled.div`\n  text-align: center;\n  color: #7f8c8d;\n  margin: 2rem 0;\n`;\n_c18 = EmptyMessage;\nconst MessageBubble = styled.div`\n  max-width: 70%;\n  padding: 1rem;\n  border-radius: 8px;\n  background-color: ${props => props.isOwnMessage ? '#3498db' : '#fff'};\n  color: ${props => props.isOwnMessage ? '#fff' : '#333'};\n  align-self: ${props => props.isOwnMessage ? 'flex-end' : 'flex-start'};\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  opacity: ${props => props.isPending ? 0.7 : 1};\n  position: relative;\n`;\n_c19 = MessageBubble;\nconst MessageHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n`;\n_c20 = MessageHeader;\nconst MessageSender = styled.span`\n  font-weight: 500;\n`;\n_c21 = MessageSender;\nconst MessageTime = styled.span`\n  font-size: 0.8rem;\n  opacity: 0.8;\n`;\n_c22 = MessageTime;\nconst MessageContent = styled.p`\n  word-break: break-word;\n`;\n_c23 = MessageContent;\nconst PendingIndicator = styled.div`\n  font-size: 0.7rem;\n  color: rgba(255, 255, 255, 0.8);\n  margin-top: 0.5rem;\n  text-align: left;\n`;\n_c24 = PendingIndicator;\nconst MessageForm = styled.form`\n  display: flex;\n  padding: 1rem;\n  background-color: #fff;\n  border-top: 1px solid #e4e4e4;\n`;\n_c25 = MessageForm;\nconst MessageInput = styled.input`\n  flex: 1;\n  padding: 0.75rem;\n  border: 1px solid #ddd;\n  border-radius: 4px 0 0 4px;\n  font-size: 1rem;\n  \n  &:focus {\n    outline: none;\n    border-color: #3498db;\n  }\n`;\n_c26 = MessageInput;\nconst SendButton = styled.button`\n  background-color: #3498db;\n  color: white;\n  border: none;\n  border-radius: 0 4px 4px 0;\n  padding: 0 1.5rem;\n  font-size: 1rem;\n  cursor: pointer;\n  \n  &:hover {\n    background-color: #2980b9;\n  }\n`;\n_c27 = SendButton;\nexport default Chat;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1, _c10, _c11, _c12, _c13, _c14, _c15, _c16, _c17, _c18, _c19, _c20, _c21, _c22, _c23, _c24, _c25, _c26, _c27;\n$RefreshReg$(_c, \"Chat\");\n$RefreshReg$(_c2, \"ChatContainer\");\n$RefreshReg$(_c3, \"ChatSidebar\");\n$RefreshReg$(_c4, \"SidebarSection\");\n$RefreshReg$(_c5, \"OnlineUsersList\");\n$RefreshReg$(_c6, \"OnlineUser\");\n$RefreshReg$(_c7, \"AdminBadge\");\n$RefreshReg$(_c8, \"PendingMessagesList\");\n$RefreshReg$(_c9, \"PendingMessage\");\n$RefreshReg$(_c0, \"PendingMessageHeader\");\n$RefreshReg$(_c1, \"PendingTime\");\n$RefreshReg$(_c10, \"PendingMessageContent\");\n$RefreshReg$(_c11, \"PendingMessageActions\");\n$RefreshReg$(_c12, \"ApproveButton\");\n$RefreshReg$(_c13, \"RejectButton\");\n$RefreshReg$(_c14, \"ChatMain\");\n$RefreshReg$(_c15, \"ChatHeader\");\n$RefreshReg$(_c16, \"MessagesContainer\");\n$RefreshReg$(_c17, \"LoadingMessage\");\n$RefreshReg$(_c18, \"EmptyMessage\");\n$RefreshReg$(_c19, \"MessageBubble\");\n$RefreshReg$(_c20, \"MessageHeader\");\n$RefreshReg$(_c21, \"MessageSender\");\n$RefreshReg$(_c22, \"MessageTime\");\n$RefreshReg$(_c23, \"MessageContent\");\n$RefreshReg$(_c24, \"PendingIndicator\");\n$RefreshReg$(_c25, \"MessageForm\");\n$RefreshReg$(_c26, \"MessageInput\");\n$RefreshReg$(_c27, \"SendButton\");","map":{"version":3,"names":["React","useState","useEffect","useRef","styled","axios","io","useAuth","Navigation","jsxDEV","_jsxDEV","Fragment","_Fragment","Chat","_s","user","messages","setMessages","newMessage","setNewMessage","pendingMessages","setPendingMessages","onlineUsers","setOnlineUsers","loading","setLoading","socketRef","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","serverUrl","process","env","REACT_APP_API_URL","emit","_id","fetchMessages","data","get","success","error","console","isAdmin","fetchPendingMessages","disconnect","on","message","prevMessages","sender","prevPending","filter","msg","messageId","log","users","socketId","sendMessage","e","preventDefault","trim","content","pendingMsg","Date","now","toString","username","createdAt","toISOString","isPending","prev","approveMessage","rejectMessage","children","fileName","_jsxFileName","lineNumber","columnNumber","ChatContainer","ChatSidebar","SidebarSection","OnlineUsersList","map","onlineUser","OnlineUser","AdminBadge","length","PendingMessagesList","_message$sender","PendingMessage","PendingMessageHeader","PendingTime","toLocaleTimeString","PendingMessageContent","PendingMessageActions","ApproveButton","onClick","RejectButton","ChatMain","ChatHeader","MessagesContainer","LoadingMessage","EmptyMessage","MessageBubble","isOwnMessage","MessageHeader","MessageSender","MessageTime","MessageContent","PendingIndicator","ref","MessageForm","onSubmit","MessageInput","type","value","onChange","target","placeholder","autoFocus","SendButton","_c","div","_c2","_c3","_c4","ul","_c5","li","_c6","span","_c7","_c8","_c9","_c0","_c1","p","_c10","_c11","button","_c12","_c13","_c14","_c15","_c16","_c17","_c18","props","_c19","_c20","_c21","_c22","_c23","_c24","form","_c25","input","_c26","_c27","$RefreshReg$"],"sources":["/home/orv/Documents/Projects/offline/offline/client/src/pages/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport styled from 'styled-components';\nimport axios from 'axios';\nimport { io } from 'socket.io-client';\nimport { useAuth } from '../context/AuthContext';\nimport Navigation from '../components/Navigation';\n\nconst Chat = () => {\n  const { user } = useAuth();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [pendingMessages, setPendingMessages] = useState([]);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  \n  const socketRef = useRef();\n  const messagesEndRef = useRef(null);\n  \n  // Scroll to the bottom of messages\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n  \n  // Initialize socket connection\n  useEffect(() => {\n    // Get the server URL from the proxy or use localhost\n    const serverUrl = process.env.REACT_APP_API_URL || 'http://localhost:5000';\n    socketRef.current = io(serverUrl);\n    \n    // Connect user\n    socketRef.current.emit('user_connected', user._id);\n    \n    // Fetch existing messages\n    const fetchMessages = async () => {\n      try {\n        const { data } = await axios.get('/api/messages');\n        if (data.success) {\n          setMessages(data.messages);\n        }\n      } catch (error) {\n        console.error('Error fetching messages:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    // If user is admin, fetch pending messages\n    if (user.isAdmin) {\n      const fetchPendingMessages = async () => {\n        try {\n          const { data } = await axios.get('/api/messages/pending');\n          if (data.success) {\n            setPendingMessages(data.messages);\n          }\n        } catch (error) {\n          console.error('Error fetching pending messages:', error);\n        }\n      };\n      \n      fetchPendingMessages();\n    }\n    \n    fetchMessages();\n    \n    // Clean up socket connection on unmount\n    return () => {\n      socketRef.current.disconnect();\n    };\n  }, [user._id, user.isAdmin]);\n  \n  // Set up socket event listeners\n  useEffect(() => {\n    if (!socketRef.current) return;\n    \n    // Receive approved messages\n    socketRef.current.on('approved_message', (message) => {\n      setMessages((prevMessages) => [...prevMessages, message]);\n      \n      // If this is one of the user's pending messages, remove it from pending\n      if (message.sender._id === user._id) {\n        setPendingMessages((prevPending) => \n          prevPending.filter((msg) => msg._id !== message._id)\n        );\n      }\n    });\n    \n    // Message was sent for approval\n    socketRef.current.on('message_sent_for_approval', (messageId) => {\n      console.log('Message sent for approval:', messageId);\n    });\n    \n    // New pending message (admin only)\n    if (user.isAdmin) {\n      socketRef.current.on('pending_approval', (message) => {\n        setPendingMessages((prevPending) => [...prevPending, message]);\n      });\n    }\n    \n    // Message was rejected (admin only)\n    socketRef.current.on('message_rejected', (messageId) => {\n      setPendingMessages((prevPending) => \n        prevPending.filter((msg) => msg._id !== messageId)\n      );\n    });\n    \n    // Online users update\n    socketRef.current.on('online_users', (users) => {\n      setOnlineUsers(users);\n    });\n    \n    // User disconnected\n    socketRef.current.on('user_disconnected', (socketId) => {\n      // This could be improved with more information from the server\n      console.log('User disconnected:', socketId);\n    });\n  }, [user._id, user.isAdmin]);\n  \n  // Scroll to bottom when messages update\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  \n  // Send a new message\n  const sendMessage = (e) => {\n    e.preventDefault();\n    \n    if (!newMessage.trim()) return;\n    \n    // Send message through socket\n    socketRef.current.emit('send_public_message', {\n      sender: user._id,\n      content: newMessage.trim(),\n    });\n    \n    // Add to pending messages for current user\n    const pendingMsg = {\n      _id: Date.now().toString(), // Temporary ID\n      sender: {\n        _id: user._id,\n        username: user.username,\n      },\n      content: newMessage.trim(),\n      createdAt: new Date().toISOString(),\n      isPending: true, // Custom flag to identify as pending in UI\n    };\n    \n    setPendingMessages((prev) => [...prev, pendingMsg]);\n    \n    // Clear input\n    setNewMessage('');\n  };\n  \n  // Approve a message (admin only)\n  const approveMessage = (messageId) => {\n    if (!user.isAdmin) return;\n    \n    socketRef.current.emit('approve_message', messageId);\n  };\n  \n  // Reject a message (admin only)\n  const rejectMessage = (messageId) => {\n    if (!user.isAdmin) return;\n    \n    socketRef.current.emit('reject_message', messageId);\n  };\n  \n  return (\n    <>\n      <Navigation />\n      <ChatContainer>\n        <ChatSidebar>\n          <SidebarSection>\n            <h3>Online Users</h3>\n            <OnlineUsersList>\n              {onlineUsers.map((onlineUser) => (\n                <OnlineUser key={onlineUser._id}>\n                  <span>{onlineUser.username}</span>\n                  {onlineUser.isAdmin && <AdminBadge>Admin</AdminBadge>}\n                </OnlineUser>\n              ))}\n            </OnlineUsersList>\n          </SidebarSection>\n          \n          {user.isAdmin && pendingMessages.length > 0 && (\n            <SidebarSection>\n              <h3>Messages Awaiting Approval</h3>\n              <PendingMessagesList>\n                {pendingMessages.map((message) => (\n                  <PendingMessage key={message._id}>\n                    <PendingMessageHeader>\n                      <span>{message.sender?.username || 'User'}</span>\n                      <PendingTime>\n                        {new Date(message.createdAt).toLocaleTimeString()}\n                      </PendingTime>\n                    </PendingMessageHeader>\n                    <PendingMessageContent>{message.content}</PendingMessageContent>\n                    <PendingMessageActions>\n                      <ApproveButton onClick={() => approveMessage(message._id)}>\n                        Approve\n                      </ApproveButton>\n                      <RejectButton onClick={() => rejectMessage(message._id)}>\n                        Reject\n                      </RejectButton>\n                    </PendingMessageActions>\n                  </PendingMessage>\n                ))}\n              </PendingMessagesList>\n            </SidebarSection>\n          )}\n        </ChatSidebar>\n        \n        <ChatMain>\n          <ChatHeader>\n            <h2>Public Chatroom</h2>\n            <p>Messages will be displayed after admin approval.</p>\n          </ChatHeader>\n          \n          <MessagesContainer>\n            {loading ? (\n              <LoadingMessage>Loading messages...</LoadingMessage>\n            ) : messages.length === 0 ? (\n              <EmptyMessage>No messages have been sent yet.</EmptyMessage>\n            ) : (\n              messages.map((message) => (\n                <MessageBubble\n                  key={message._id}\n                  isOwnMessage={message.sender._id === user._id}\n                >\n                  <MessageHeader>\n                    <MessageSender>{message.sender.username}</MessageSender>\n                    <MessageTime>\n                      {new Date(message.createdAt).toLocaleTimeString()}\n                    </MessageTime>\n                  </MessageHeader>\n                  <MessageContent>{message.content}</MessageContent>\n                </MessageBubble>\n              ))\n            )}\n            \n            {/* Show user's pending messages */}\n            {pendingMessages\n              .filter((message) => message.sender._id === user._id)\n              .map((message) => (\n                <MessageBubble key={message._id} isOwnMessage isPending>\n                  <MessageHeader>\n                    <MessageSender>{message.sender.username}</MessageSender>\n                    <MessageTime>\n                      {new Date(message.createdAt).toLocaleTimeString()}\n                    </MessageTime>\n                  </MessageHeader>\n                  <MessageContent>{message.content}</MessageContent>\n                  <PendingIndicator>Awaiting Approval</PendingIndicator>\n                </MessageBubble>\n              ))}\n            \n            <div ref={messagesEndRef} />\n          </MessagesContainer>\n          \n          <MessageForm onSubmit={sendMessage}>\n            <MessageInput\n              type=\"text\"\n              value={newMessage}\n              onChange={(e) => setNewMessage(e.target.value)}\n              placeholder=\"Type your message...\"\n              autoFocus\n            />\n            <SendButton type=\"submit\">Send</SendButton>\n          </MessageForm>\n        </ChatMain>\n      </ChatContainer>\n    </>\n  );\n};\n\nconst ChatContainer = styled.div`\n  display: flex;\n  height: calc(100vh - 60px);\n  max-width: 1400px;\n  margin: 0 auto;\n  background-color: #f8f9fa;\n`;\n\nconst ChatSidebar = styled.div`\n  width: 300px;\n  background-color: #fff;\n  border-left: 1px solid #e4e4e4;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst SidebarSection = styled.div`\n  padding: 1.5rem;\n  border-bottom: 1px solid #e4e4e4;\n  \n  h3 {\n    margin-bottom: 1rem;\n    font-size: 1rem;\n    color: #2c3e50;\n  }\n`;\n\nconst OnlineUsersList = styled.ul`\n  list-style: none;\n  padding: 0;\n`;\n\nconst OnlineUser = styled.li`\n  padding: 0.5rem;\n  margin-bottom: 0.5rem;\n  background-color: #f8f9fa;\n  border-radius: 4px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n\nconst AdminBadge = styled.span`\n  background-color: #e74c3c;\n  color: white;\n  font-size: 0.7rem;\n  padding: 0.2rem 0.4rem;\n  border-radius: 3px;\n`;\n\nconst PendingMessagesList = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  max-height: 400px;\n  overflow-y: auto;\n`;\n\nconst PendingMessage = styled.div`\n  background-color: #f8f9fa;\n  border: 1px solid #e4e4e4;\n  border-radius: 4px;\n  padding: 1rem;\n`;\n\nconst PendingMessageHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n  \n  span {\n    font-weight: 500;\n  }\n`;\n\nconst PendingTime = styled.span`\n  font-size: 0.8rem;\n  color: #7f8c8d;\n`;\n\nconst PendingMessageContent = styled.p`\n  margin-bottom: 1rem;\n`;\n\nconst PendingMessageActions = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  gap: 0.5rem;\n`;\n\nconst ApproveButton = styled.button`\n  background-color: #2ecc71;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 0.5rem 0.8rem;\n  font-size: 0.8rem;\n  cursor: pointer;\n  \n  &:hover {\n    background-color: #27ae60;\n  }\n`;\n\nconst RejectButton = styled.button`\n  background-color: #e74c3c;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 0.5rem 0.8rem;\n  font-size: 0.8rem;\n  cursor: pointer;\n  \n  &:hover {\n    background-color: #c0392b;\n  }\n`;\n\nconst ChatMain = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst ChatHeader = styled.div`\n  padding: 1.5rem;\n  background-color: #fff;\n  border-bottom: 1px solid #e4e4e4;\n  text-align: center;\n  \n  h2 {\n    margin-bottom: 0.5rem;\n  }\n  \n  p {\n    color: #7f8c8d;\n    font-size: 0.9rem;\n  }\n`;\n\nconst MessagesContainer = styled.div`\n  flex: 1;\n  padding: 1.5rem;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n`;\n\nconst LoadingMessage = styled.div`\n  text-align: center;\n  color: #7f8c8d;\n  margin: 2rem 0;\n`;\n\nconst EmptyMessage = styled.div`\n  text-align: center;\n  color: #7f8c8d;\n  margin: 2rem 0;\n`;\n\nconst MessageBubble = styled.div`\n  max-width: 70%;\n  padding: 1rem;\n  border-radius: 8px;\n  background-color: ${(props) => (props.isOwnMessage ? '#3498db' : '#fff')};\n  color: ${(props) => (props.isOwnMessage ? '#fff' : '#333')};\n  align-self: ${(props) => (props.isOwnMessage ? 'flex-end' : 'flex-start')};\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  opacity: ${(props) => (props.isPending ? 0.7 : 1)};\n  position: relative;\n`;\n\nconst MessageHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n`;\n\nconst MessageSender = styled.span`\n  font-weight: 500;\n`;\n\nconst MessageTime = styled.span`\n  font-size: 0.8rem;\n  opacity: 0.8;\n`;\n\nconst MessageContent = styled.p`\n  word-break: break-word;\n`;\n\nconst PendingIndicator = styled.div`\n  font-size: 0.7rem;\n  color: rgba(255, 255, 255, 0.8);\n  margin-top: 0.5rem;\n  text-align: left;\n`;\n\nconst MessageForm = styled.form`\n  display: flex;\n  padding: 1rem;\n  background-color: #fff;\n  border-top: 1px solid #e4e4e4;\n`;\n\nconst MessageInput = styled.input`\n  flex: 1;\n  padding: 0.75rem;\n  border: 1px solid #ddd;\n  border-radius: 4px 0 0 4px;\n  font-size: 1rem;\n  \n  &:focus {\n    outline: none;\n    border-color: #3498db;\n  }\n`;\n\nconst SendButton = styled.button`\n  background-color: #3498db;\n  color: white;\n  border: none;\n  border-radius: 0 4px 4px 0;\n  padding: 0 1.5rem;\n  font-size: 1rem;\n  cursor: pointer;\n  \n  &:hover {\n    background-color: #2980b9;\n  }\n`;\n\nexport default Chat; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}